<div class="navbar navbar-default navbar-static-top" role="navigation" ng-controller="NavbarController">
  <div class="container">
    <div class="navbar-header">
      <a class="navbar-brand" href="/">
        <img src="images/Bountysource-green.png" style="height: 30px;" />
      </a>
    </div>

    <div class="navbar-collapse">
      <!-- Search input -->
      <form class="navbar-form navbar-left" role="search">
        <div class="form-group">
          <input type="text" class="form-control" ng-model="search_query" placeholder="Issue URL, Project, Language, etc." />
        </div>
        <button class="btn btn-default" type="submit">
          <i class="glyphicon glyphicon-search"></i>
        </button>
      </form>

      <ul class="nav navbar-nav navbar-right">
        <li class="visible-lg visible-md"><a href="http://blog.bountysource.com" target="_blank">Blog</a></li>
        <li class="visible-lg visible-md"><a href="/teams">Teams</a></li>
        <li class="visible-lg visible-md"><a href="/enterprise" >Enterprise</a></li>

        <!-- User dropdown if logged in -->
        <li class="dropdown" ng-if="current_person">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">
            <img class="img-rounded" ng-src="{{current_person.image_url}}" style="height: 20px; width: 20px;" />
            {{current_person.display_name}}
            <b class="caret"></b>
          </a>
          <ul class="dropdown-menu">
            <li role="presentation" class="dropdown-header"><i class="glyphicon glyphicon-bullhorn"></i> Activity</li>
            <li><a href="activity">Timeline</a></li>
            <li><a href="activity/bounties">Bounties</a></li>
            <li><a href="activity/pledges">Pledges</a></li>
            <li><a href="activity/fundraisers">Fundraisers</a></li>
            <li><a href="activity/claims">Bounty Claims</a></li>
            <li><a href="activity/transactions">Transactions</a></li>
            <li role="presentation" class="divider"></li>

            <!-- Teams submenu -->
            <li ng-if="current_person.teams">

            </li>

            <li><a owner-href="current_person"><i class="glyphicon glyphicon-user"></i> Profile</a></li>
            <li><a href="activity/account"><i class="glyphicon glyphicon-gift"></i> Balance <span class="label label-primary">{{current_person.account.balance | currency}}</span></a></li>
            <li role="presentation" class="divider"></li>

            <li role="presentation" class="dropdown-header"><i class="glyphicon glyphicon-cog"></i> Settings</li>
            <li><a href="settings">Profile</a></li>
            <li><a href="settings/accounts">Linked Accounts</a></li>
            <li><a href="settings/accounts">Email</a></li>
            <li role="presentation" class="divider"></li>

            <li><a href="#" ng-click="signout()"><i class="glyphicon glyphicon-off"></i> Sign Out</a></li>
          </ul>
        </li>

        <!-- Sign in dropdown if not logged in -->
        <li class="dropdown" ng-controller="SigninController" ng-if="!current_person">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Sign In <b class="caret"></b></a>
          <ul class="dropdown-menu" ng-hide="!!current_person" ng-controller="NavbarLinkedAccountSignin">
            <li role="presentation" class="dropdown-header">Login using:</li>

            <li ng-repeat="provider in providers" role="signin">
              <!-- Link with Google Analytics event tracking -->
              <a gaq-track-click ng-href="{{signin_url_for(provider.id)}}" gaq-args="['_trackEvent', 'Navbar-Signin' , 'LinkOut']" id="navbar-provider-{{provider.id}}" ng-click="save_route()">
                <span><img ng-src="{{provider.image_url}}"> {{provider.name}}</span>
              </a>
            </li>
            <li>
              <a href="/signin">
                <i class="glyphicon glyphicon-envelope"></i>
                Email Address
              </a>
            </li>
          </ul>
        </li>

        <!-- Development tools. Environment changer and access token changer. -->
        <li class="dropdown" ng-if="can_switch_environments">
          <a ng-href="/people/{{person.slug}}" class="dropdown-toggle" data-toggle="dropdown">
            <span class="label label-danger">{{environment}}</span>
            <b class="caret"></b>
          </a>

          <ul class="dropdown-menu" ng-controller="NavbarController">
            <li><a href="" ng-click="setEnv('dev')">development</a></li>
            <li><a href="" ng-click="setEnv('staging')">staging</a></li>
            <li><a href="" ng-click="setEnv('prod')">production</a></li>
            <li class="divider"></li>
            <li>
              <a href="" ng-click="set_access_token.open()">set access token</a>
              <div modal="set_access_token.show_modal" close="set_access_token.close()">
                <div class="modal-header">
                  <h2>Set access token</h2>
                </div>
                <div class="modal-body">
                  <form ng-submit="set_access_token.save()">
                    <input ng-model="set_access_token.new_token" autofocus style="width: 98%;" type="text" placeholder="Super secret access token goes here..." />
                    <br />
                    <button type="submit" class="btn btn-primary">Steal Identity</button>
                    <button class="btn btn-default" ng-click="set_access_token.close()">Cancel</button>
                  </form>
                </div>
              </div>
            </li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</div>
